ssm中的xml配置被取缔

约定大于配置 - 约定成俗的东西就不需要再去配置

[Spring | Home](https://spring.io/)

没有spring的时候 打包成 war包

有了spring之后,打包成jar包



#### SpringBoot

##### java基础

[Thymeleaf一篇就够了-阿里云开发者社区 (aliyun.com)](https://developer.aliyun.com/article/769977)

[(163条消息) java框架中的controller层、dao层、domain层、service层、view层_Mr_wilson_liu的博客-CSDN博客_domain层和service层](https://blog.csdn.net/Mr_wilson_liu/article/details/104172717)

[RestTemplate 最详解 - 程序员自由之路 - 博客园 (cnblogs.com)](https://www.cnblogs.com/54chensongxia/p/11414923.html)



###### Maven

jar包的管理和部署

[Maven是什么？ Maven的概念+作用+仓库的介绍+常用命令 - 腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1705945)



###### pom

[(162条消息) maven：pom文件详解_夜雨落花的博客-CSDN博客_tofile pom](https://blog.csdn.net/weixin_38569499/article/details/91456988)



###### bean

[(162条消息) Java Bean详解_顺其自然~的博客-CSDN博客_bean java](https://blog.csdn.net/fuhanghang/article/details/84074561)

[(161条消息) Spring容器是什么(浅显易懂)？_robona的博客-CSDN博客_spring容器是什么](https://blog.csdn.net/qq_34598667/article/details/83245753)

[(162条消息) 三种实例化bean方式——Spring对bean的管理（一）_robona的博客-CSDN博客](https://blog.csdn.net/qq_34598667/article/details/83246492)

[(163条消息) 【Spring Boot】个人对Serializable的理解_无敌嗨猫的博客-CSDN博客](https://blog.csdn.net/m0_37374307/article/details/105264080)

[SpringBoot @Autowired解析 - 简书 (jianshu.com)](https://www.jianshu.com/p/4501b57df9cd)







##### 架构

[(162条消息) SpringBoot框架_星悦糖的博客-CSDN博客_springboot](https://blog.csdn.net/friggly/article/details/123888590?ops_request_misc=%7B%22request%5Fid%22%3A%22167289921316800182785603%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=167289921316800182785603&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-123888590-null-null.142^v68^control,201^v4^add_ask,213^v2^t3_esquery_v1&utm_term=springboot&spm=1018.2226.3001.4187)

[(162条消息) Spring Framework（框架）整体架构（不知道就有些搞笑了哈）_向小凯同学学习的博客-CSDN博客_springframework](https://blog.csdn.net/wd2014610/article/details/80061808)







[(163条消息) SpringBoot配置类整理_Ricost的博客-CSDN博客](https://blog.csdn.net/Ricost/article/details/109533083)

###### controller

[(163条消息) SpringBoot基础之控制层Controller详解_刘三二的博客-CSDN博客_controller层主要做什么](https://blog.csdn.net/qq_22157917/article/details/98490976)









[WebJars简介 —— 前端资源的jar包形式（以后接触到再深入总结） - 小破孩楼主 - 博客园 (cnblogs.com)](https://www.cnblogs.com/zouhong/p/11835308.html)



##### 配置

[(162条消息) SpringBoot中application.yml基本配置详情_liuyuinsdu的博客-CSDN博客_application.yml](https://blog.csdn.net/liuyuinsdu/article/details/114248717?ops_request_misc=%7B%22request%5Fid%22%3A%22167281453616800182125423%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=167281453616800182125423&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-114248717-null-null.142^v68^control,201^v4^add_ask,213^v2^t3_esquery_v1&utm_term=application yml&spm=1018.2226.3001.4187)



###### 数据源 DataSource

 [(162条消息) Springboot数据源datasource解析_Java之链的博客-CSDN博客_springboot数据源深入理解](https://blog.csdn.net/victory_long/article/details/113096374#:~:text=什么是数据源？. Java中的数据源就是连接到数据库的一条路径，数据源中并无真正的数据，它仅仅记录的是你连接到哪个数据库，以及如何连接。. DataSource的创建可以有不同的实现。. DataSource通常被称为数据源，它包含连接池 和连接池管理 两部分，习惯上也经常把DataSource称为连接池。. Spring,Boot 默认支持的数据源. Java的javax.sql.DataSource接口提供了一种使用数据库连接的标准方法。. 传统上的'DataSource'使用URL等一些配置来建立数据库连接。. 目前一些开源组织都提供了数据源的独立实现。. Spring Boot默认支持4种数据源类型，分别是：.)

[(162条消息) Springboot 配置 application.yml 连接MySQL数据库_三毛村滴雪鱼粉的博客-CSDN博客](https://blog.csdn.net/xfx_1994/article/details/104218872?ops_request_misc=&request_id=&biz_id=102&utm_term=application.yml DataSource&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-104218872.142^v68^control,201^v4^add_ask,213^v2^t3_esquery_v1&spm=1018.2226.3001.4187)

[(162条消息) 连接MySQL时的url解析_@Hmily@的博客-CSDN博客_连接mysqlurl](https://blog.csdn.net/wqh0830/article/details/85883398)





###### 注解

[@Autowired用法详解 - Boblim - 博客园 (cnblogs.com)](https://www.cnblogs.com/fnlingnzb-learner/p/9723834.html)







[@ResponseBody详解_originations的博客-CSDN博客_@responsebody](https://blog.csdn.net/originations/article/details/89492884)







#### 插件







引入插件

1. 需要 在 pom.xml 文件中引入
2. 在Maven中刷新,自动进行下载







##### Lombok

[(162条消息) Lombok简介、使用、工作原理、优缺点_ThinkWon的博客-CSDN博客_lombok](https://blog.csdn.net/ThinkWon/article/details/101392808)

通过注解的方式,来简化java代码

比如,data注解来自动生成setter,getter方法,Slf4j注解来自动生成log日志变量



[(162条消息) Lombok的@AllArgsConstructor注解_我是坑货的博客-CSDN博客_lombok.allargsconstructor](https://blog.csdn.net/FeiChangWuRao/article/details/124438786)





##### swagger

开发工具

通过使用该插件,可以提供一个页面来进行对于项目可视化地管理,需要使用相关的注解,于是该方法就可以在页面中显示并提供调用的button



##### mybatis数据库

数据库

对于类中定义的方法,可以通过xml文件进行实现 - 建立映射



[QueryDSL——比SpringData JPA更面向对象 - 掘金 (juejin.cn)](https://juejin.cn/post/6908990542583955469)

[图解Java JDBC和JPA的区别 - 快乐随行 - 博客园 (cnblogs.com)](https://www.cnblogs.com/jddreams/p/14024754.html)



[SpringBoot的@GeneratedValue注解_RichardGeek的博客-CSDN博客](https://blog.csdn.net/CoderTnT/article/details/81178496)







##### Security

进行安全控制,如果使用了此组件,那么对于该项目的所有页面访问会自动跳转到 login界面进行登陆

- 登陆
  - 对用户进行注册
    - 连接数据库
    - 内存型用户
  - 过滤,忽略(指的是有些页面,比如index页面,不需要进行登陆即可访问)
    - 过滤链
- 权限控制
  - 对于Vip用户和common用户进行不同的管理
  - 禁止对于静态资源的访问



##### Quartz

进行schedule



- job - 任务,描述你要做什么事情
- trigger - 触发器,什么时候去做这件事情
- scheduler - 任务调度,你什么时候需要做什么事情



1. 创建一个配置类来配置信息
2. 去创建一个定时器的任务
   1. 创建 任务类
   2. 创建 detail 2和3在配置类中定义
   3. 创建 trigger
      1. [cron 表达式详解 - 腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1674682)













##### WebSocket

[官方文档 Getting Started | Using WebSocket to build an interactive web application (spring.io)](https://spring.io/guides/gs/messaging-stomp-websocket/)

[WebSocket 教程 - 阮一峰的网络日志 (ruanyifeng.com)](https://www.ruanyifeng.com/blog/2017/05/websocket.html)

允许服务器向客户端主动推送数据

在单个tcp的连接上进行全双工的通信

- 适用于不需要轮询的业务



STOMP子协议





#### springcloud

微服务

是一种架构风格: 将一个单一个应用程序,划分成一组小的服务,目的是为了去耦合

类似于进程,独立运行和终止,每一个拥有自己的数据库



- 服务消费者 - 调用服务的一方
- 服务器工程 - 被调用,提供服务的一方



对于两个微服务之间的公用对象,采用公共依赖进行解耦合



[(162条消息) 微服务（一）—— 项目结构_CodAlun的博客-CSDN博客_微服务项目结构](https://blog.csdn.net/CodAlun/article/details/118960044)

[(162条消息) 微服务（二）—— 公共模块（backend-common）_CodAlun的博客-CSDN博客_微服务公共模块](https://blog.csdn.net/CodAlun/article/details/118961560)





创建公共依赖



- 父工程只需要申明关系(公共依赖),而不需要实现业务,即不需要写源代码,src文件夹可以直接删除掉
- pom文件中,申明打包为pom文件
  - [(162条消息) Maven项目中＜packaging＞pom＜/packaging＞的意思_辰阳星宇的博客-CSDN博客_packaging pom](https://blog.csdn.net/qq_41094332/article/details/108497080#:~:text=在多个 项目 聚合时，指定packing为 pom 在创建 maven 父工程时，需要指定打包方式为 pom,pom ，所以packing为 pom 。 如果没有将packing 指定为 pom ，那么子模块之间是无法进行依赖传递。)
  - 













































































#### querydsl

DTO和PO

- DTO是数据传输对象 - bean
  - 其内容为message和一些返回信息,初步判断为是在网络中传输的数据结构以对象方式定义
- PO是持久化对象 - 面向sql的查询对象
  - 数据表 - 数据表中的字段对应于PO的一个属性
  - ==querydsl根据PO对象生成Q开头的对象==
- querydsl根据PO对象生成Q开头的对象
  - 内含path对象,用于查询



QUser: 是自动生成的查询类,



































#### 项目参数

json中 

- code - 0和1返回结果是否正确
- message - 根据场景确定



发送 IP端口+url+参数

- 4000

返回 json





###### 前后端交互

1. login
   1. 发送 get
   2. 返回:
      1. code: 0和1表示登陆是否成功
      2. > sid: 用户身份标识(暂定)
2. register
   1. 发送 post
   2. 返回
      1. code: 01表示注册成功失败
         1. 注册失败意味着用户名重复,其他注册失败的情况由前端表单检测完成
      2. sid: sid由 username,userId 加密生成
3. home
   1. 创建房间 createRoom
      1. 发送 get 
         1. sid
      2. 返回
         1. code 01成功失败
         2. 会议号 roomId- 由后端创建返回
   2. 加入房间 joinRoom
      1. 发送 get
         1. sid
         2. roomId
      2. 返回
         1. code 01成功失败
4. 获取用户信息
   1. 发送
      1. sid
   2. 返回
      1. username
      2. avatar 用户头像
5. 历史会议 /history
   1. 发送 
      1. 

   2. 返回
      1. 结构体 map
         1. username - 发起人
         2. roomid - 非主键
         3. 创建时间 - 为每次会议的创建时间,如果存在ID相同的会议,其不同在于创建时间







 

##### 历史会议业务逻辑

 

首先,创建历史会议条目的时机(在表中插入条目)是在 (@GetMapping("/createRoom"))中

当有人通过 @GetMapping("/joinRoom")参加会议时, 我们会在表中通过 roomId进行查找,由于历史会议中会存在相同会议号,所以会在表中增加一条属性( isAlive ),相同会议号中至多只有一个会议是alive的

所以需要增加残留会议消亡的逻辑, 目前会议的持续时长上限为 40min, 所以会在 createRoom时,对历史会议进行select, 同roomId中,判断是否有 alive会议, 若存在alive会议, 则判断其 createTime - 当前时间 是否大于 40min, 若大于则将该 alive置为false, 并插入新会议,若 若小于则重新生成一个RoomId.

同时,在参加会议时, 需要对history中的该条目中的 participator进行非重复性插入



loadHistory中,存在一个问题是,如果按照之前的逻辑,要加载出参加过的会议,则需要在表中对每个会议记录的participators进行解析再判断,所以,如果要记录一个用户参加过哪些会议,不如直接设一张表,表中内容就是 每个用户的参会情况



joinLog表 - 记录每次每个用户的参与情况

load时,先查询joinlog表,得到参与会议的Id(是记录id而不是roomId),然后根据Ids得到 记录list,然后按要求返回渲染




#### 数据库表



1. user表

2. 会议表

   1. 会议号

   2. 创建时间

   3. 创建者token

      









#### 原理

###### 自动配置

为什么有时候在pom.xml中可以不需要对dependency的version(版本号)进行显式的表明?

我们可以点击<parent>中的<version>字段来跳转至其父工程中,可以看到在其中已经对所依赖的jar包进行了版本控制(版本仓库 )



###### starter

我们会在pom.xml下的依赖列表中看到许多带有starter的dependency,这些就是一个个的启动器,springboot将各种功能场景变成了启动器,比如说spring-boot-starter-web,他会帮我们导入web环境所需要的全部依赖,相当于依赖的合集



###### 主程序

即为application文件,也就是在代码目录中,和其他文件夹位于同级的一个springbootapplication













外网面板地址: https://8.130.41.106:14324/c51d8639
内网面板地址: https://172.17.160.69:14324/c51d8639
username: 2lnjmeog
password: f5189938



lsof -i port



 nohup /usr/bin/java -jar  /root/chat_backend/suc-chat-backend-0.0.1-SNAPSHOT.jar 



nohup java -jar suc-chat-backend-0.0.1-SNAPSHOT.jar > out.txt













